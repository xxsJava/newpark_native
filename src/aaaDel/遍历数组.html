<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- 引入转换拼音及首字母的js文件 -->
    <script src="./Convert_Pinyin.js"></script>
    <script>
        // 模拟接口获取的数据
        let getData = [
                    {
                        "addSource": 2, 
                        "createTime": 1714120075, 
                        "ex": "", 
                        "friendUser": {"appMangerLevel": 0, "createTime": 0, "ex": "", "faceURL": "", "globalRecvMsgOpt": 0, "nickname": "娜娜", "userID": "1548714649"},
                        "operatorUserID": "10000", 
                        "ownerUserID": "10000", 
                        "remark": ""
                    },
                    {
                        "addSource": 3, 
                        "createTime": 1698320075, 
                        "ex": "", 
                        "friendUser": {"appMangerLevel": 0, "createTime": 0, "ex": "", "faceURL": "", "globalRecvMsgOpt": 0, "nickname": "小明", "userID": "1548714649"},
                        "operatorUserID": "10000", 
                        "ownerUserID": "10000", 
                        "remark": ""
                    },
                    {
                        "addSource": 4, 
                        "createTime": 1986320075, 
                        "ex": "", 
                        "friendUser": {"appMangerLevel": 0, "createTime": 0, "ex": "", "faceURL": "", "globalRecvMsgOpt": 0, "nickname": "红红", "userID": "1548714649"},
                        "operatorUserID": "10000", 
                        "ownerUserID": "10000", 
                        "remark": ""
                    },
                    {
                        "addSource": 4, 
                        "createTime": 1986320075, 
                        "ex": "", 
                        "friendUser": {"appMangerLevel": 0, "createTime": 0, "ex": "", "faceURL": "", "globalRecvMsgOpt": 0, "nickname": "小亮", "userID": "1548714649"},
                        "operatorUserID": "10000", 
                        "ownerUserID": "10000", 
                        "remark": ""
                    }
                ];

        
        // 声明一个空数组
        let newArr = [];
        // 遍历获取的数组
        for (let i of getData) {
            // 获取每个对象的 nickname 的首字母
            let firstName = pinyin.getCamelChars(i.friendUser.nickname.charAt(0));
            console.log(firstName);
            // 如果数组里面没有泽创建一个对象
            if (newArr.filter(item => item.title == firstName).length == 0) {
                let obj = {
                    title: firstName,
                    data: [i]
                };
                newArr.push(obj);
            // 如果数组里面有 就直接添加
            } else {
                newArr.forEach((item, index) => {
                    if (item.title == firstName) {
                        newArr[index].data.push(i)
                    }
                })
            }           
        }
        console.log(newArr);
    </script>
</body>
</html>